
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mydomain.org/mysite/04-implementacion/">
      
      
        <link rel="prev" href="../03-desarrollo/">
      
      
        <link rel="next" href="../05-resultados/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Implementacion - Trabajo Final de Trafico</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#implementacion-del-escenario" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Trabajo Final de Trafico" class="md-header__button md-logo" aria-label="Trabajo Final de Trafico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Trabajo Final de Trafico
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Implementacion
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../coding/implementacion_yml/" class="md-tabs__link">
          
  
  Code Docs

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../01-introduccion_objs/" class="md-tabs__link">
        
  
    
  
  Introduccion y Objetivos

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../02-marco_teorico/" class="md-tabs__link">
        
  
    
  
  Marco Teorico

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../03-desarrollo/" class="md-tabs__link">
        
  
    
  
  Desarrollo

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Implementacion

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../05-resultados/" class="md-tabs__link">
        
  
    
  
  Resultados

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../06-conclusiones/" class="md-tabs__link">
        
  
    
  
  Conclusiones

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../07-networking/" class="md-tabs__link">
        
  
    
  
  Networking

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Trabajo Final de Trafico" class="md-nav__button md-logo" aria-label="Trabajo Final de Trafico" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Trabajo Final de Trafico
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coding/implementacion_yml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    yaml
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coding/implementacion_py/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coding/implementacion_bash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bash
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-introduccion_objs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduccion y Objetivos
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-marco_teorico/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Marco Teorico
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-desarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desarrollo
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Implementacion
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Implementacion
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#diagrama-de-red" class="md-nav__link">
    <span class="md-ellipsis">
      Diagrama de Red
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uso-del-framework-web-fastapi-para-la-creacion-del-servidor" class="md-nav__link">
    <span class="md-ellipsis">
      Uso del Framework WEB FastAPI para la creación del servidor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dockerizacion-del-servidor-para-despliegue-en-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerizacion del servidor para despliegue en Kubernetes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#despligue-del-cluster-con-minikube" class="md-nav__link">
    <span class="md-ellipsis">
      Despligue del cluster con Minikube
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Despligue del cluster con Minikube">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion-de-minikube" class="md-nav__link">
    <span class="md-ellipsis">
      Instalacion de Minikube
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inicializacion-del-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Inicialización del cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#se-activan-algunos-addons" class="md-nav__link">
    <span class="md-ellipsis">
      Se activan algunos addons:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubectl" class="md-nav__link">
    <span class="md-ellipsis">
      Kubectl
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kubectl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion" class="md-nav__link">
    <span class="md-ellipsis">
      Instalacion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validar-version" class="md-nav__link">
    <span class="md-ellipsis">
      Validar version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualiza-servicios" class="md-nav__link">
    <span class="md-ellipsis">
      Visualiza servicios:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualiza-pods" class="md-nav__link">
    <span class="md-ellipsis">
      Visualiza PODs:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#muestra-el-consumo-de-cpu-de-los-pods" class="md-nav__link">
    <span class="md-ellipsis">
      Muestra el consumo de CPU de los PODs:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizar-todo-el-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizar todo el cluster:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aplicacion-de-los-archivos-de-configuracion" class="md-nav__link">
    <span class="md-ellipsis">
      Aplicacion de los archivos de configuracion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tipos-de-archivos-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Tipos de archivos YAML:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uso-del-comando-socat" class="md-nav__link">
    <span class="md-ellipsis">
      Uso del comando socat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-en-el-cliente" class="md-nav__link">
    <span class="md-ellipsis">
      Configuracion en el cliente:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generacion-de-trafico" class="md-nav__link">
    <span class="md-ellipsis">
      Generacion de trafico
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#balanceador-de-cargas" class="md-nav__link">
    <span class="md-ellipsis">
      Balanceador de cargas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nodos" class="md-nav__link">
    <span class="md-ellipsis">
      Nodos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pods-servidores" class="md-nav__link">
    <span class="md-ellipsis">
      PODs / Servidores
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-resultados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resultados
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-conclusiones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conclusiones
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-networking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Networking
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="implementacion-del-escenario">Implementacion del escenario</h1>
<h2 id="diagrama-de-red">Diagrama de Red</h2>
<p><img alt="Diagrama de Red" src="../img/diagrama_red.png" /></p>
<p>EL diagrama se puede encontrar en el siguiente enlace:</p>
<p><a href="https://app.diagrams.net/#G1ghEZxJdSY9GOKYjAYBucALTVTNkAHxzV#%7B%22pageId%22%3A%22AK9kH2OWGDXMvQ3oLW55%22%7D">Diagrama</a></p>
<h2 id="uso-del-framework-web-fastapi-para-la-creacion-del-servidor">Uso del Framework WEB FastAPI para la creación del servidor</h2>
<p>Se detalla como alojar el servidor que recibira las peticiones desde el cliente, con el se crearan los endpoints para devolver los tiempos de respuesta de cada peticion siguiendo una distribucion exponencial- </p>
<p>Para mas detalles del codigo: <a href="../coding/implementacion_py/#servidor-de-respuestas-a-peticiones-http">script del servidor</a></p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>.
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├──<span class="w"> </span>Dockerfile
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├──<span class="w"> </span>requirements.txt
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>└──<span class="w"> </span>server.py
</span></code></pre></div>
<strong>requirements.txt</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>fastapi
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>uvicorn
</span></code></pre></div></p>
<p><strong>Dockerfile</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Usamos una imagen base oficial de Python</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>FROM<span class="w"> </span>python:3.11-slim
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Establecemos el directorio de trabajo en la imagen</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>WORKDIR<span class="w"> </span>/app
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># Copiamos el archivo requirements.txt (si tienes uno) a la imagen</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>COPY<span class="w"> </span>requirements.txt<span class="w"> </span>/app/
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># Instalamos las dependencias de Python</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>RUN<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="c1"># Copiamos el código de la aplicación a la imagen</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>COPY<span class="w"> </span>.<span class="w"> </span>/app/
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="c1"># Exponemos el puerto que usa la aplicación FastAPI (por defecto es 8000)</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>EXPOSE<span class="w"> </span><span class="m">8000</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c1"># Comando para ejecutar la aplicación usando Uvicorn</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>CMD<span class="w"> </span><span class="o">[</span><span class="s2">&quot;uvicorn&quot;</span>,<span class="w"> </span><span class="s2">&quot;server:app&quot;</span>,<span class="w"> </span><span class="s2">&quot;--host&quot;</span>,<span class="w"> </span><span class="s2">&quot;0.0.0.0&quot;</span>,<span class="w"> </span><span class="s2">&quot;--port&quot;</span>,<span class="w"> </span><span class="s2">&quot;8000&quot;</span><span class="o">]</span>
</span></code></pre></div>
<hr />
<h2 id="dockerizacion-del-servidor-para-despliegue-en-kubernetes">Dockerizacion del servidor para despliegue en Kubernetes</h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">#Nos ubicamos dentro de la carpeta donde estan los tres archivos antes mencionados</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span><span class="s2">&quot;nombre de usuario&quot;</span>/miapp:latest<span class="w"> </span>.
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>docker<span class="w"> </span>push<span class="w"> </span><span class="s2">&quot;nombre de usuario&quot;</span>/miapp:latest
</span></code></pre></div>
<hr />
<h2 id="despligue-del-cluster-con-minikube">Despligue del cluster con Minikube</h2>
<h3 id="instalacion-de-minikube">Instalacion de Minikube</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span>https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>sudo<span class="w"> </span>install<span class="w"> </span>minikube-linux-amd64<span class="w"> </span>/usr/local/bin/minikube
</span></code></pre></div>
<h3 id="inicializacion-del-cluster">Inicialización del cluster</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>minikube<span class="w"> </span>start<span class="w"> </span>--driver<span class="o">=</span><span class="s2">&quot;virtualbox&quot;</span><span class="w"> </span>--memory<span class="o">=</span><span class="s2">&quot;ram&quot;</span><span class="w"> </span>--cpus<span class="o">=</span><span class="s2">&quot;cantidad&quot;</span><span class="w"> </span>--nodes<span class="o">=</span><span class="s2">&quot;cantidad de nodos&quot;</span>
</span></code></pre></div>
<h3 id="se-activan-algunos-addons">Se activan algunos addons:</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>minikube<span class="w"> </span>addons<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>ingress
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>minikube<span class="w"> </span>addons<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>metrics-server
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>minikube<span class="w"> </span>addons<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>dashboard
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c1">#Inicializa el dashboard</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>minikube<span class="w"> </span>dashboard
</span></code></pre></div>
<p>Una vez iniciado el cluster se procede a deployar los archivos de configuración .yaml:</p>
<h2 id="kubectl">Kubectl</h2>
<h3 id="instalacion">Instalacion</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>curl<span class="w"> </span>-LO<span class="w"> </span><span class="s2">&quot;https://dl.k8s.io/release/</span><span class="k">$(</span>curl<span class="w"> </span>-L<span class="w"> </span>-s<span class="w"> </span>https://dl.k8s.io/release/stable.txt<span class="k">)</span><span class="s2">/bin/linux/amd64/kubectl&quot;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c1">#Validar binario</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>curl<span class="w"> </span>-LO<span class="w"> </span><span class="s2">&quot;https://dl.k8s.io/release/</span><span class="k">$(</span>curl<span class="w"> </span>-L<span class="w"> </span>-s<span class="w"> </span>https://dl.k8s.io/release/stable.txt<span class="k">)</span><span class="s2">/bin/linux/amd64/kubectl.sha256&quot;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>cat<span class="w"> </span>kubectl.sha256<span class="k">)</span><span class="s2">  kubectl&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sha256sum<span class="w"> </span>--check
</span></code></pre></div>
<h3 id="validar-version">Validar version</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>kubectl<span class="w"> </span>version<span class="w"> </span>--client
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span><span class="o">(</span>archivo.yaml<span class="o">)</span>
</span></code></pre></div>
<h3 id="visualiza-servicios">Visualiza servicios:</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>svc
</span></code></pre></div>
<h3 id="visualiza-pods">Visualiza PODs:</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</span></code></pre></div>
<h3 id="muestra-el-consumo-de-cpu-de-los-pods">Muestra el consumo de CPU de los PODs:</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>kubectl<span class="w"> </span>top<span class="w"> </span>pods
</span></code></pre></div>
<h3 id="visualizar-todo-el-cluster">Visualizar todo el cluster:</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>kubectl<span class="w"> </span>get<span class="w"> </span>all
</span></code></pre></div>
<h2 id="aplicacion-de-los-archivos-de-configuracion">Aplicacion de los archivos de configuracion</h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span><span class="m">01</span>-deployment.yaml<span class="w"> </span><span class="m">02</span>-service.yaml<span class="w"> </span><span class="m">03</span>-ingress.yaml
</span></code></pre></div>
<h2 id="tipos-de-archivos-yaml">Tipos de archivos YAML:</h2>
<p>Los implementados en este proyecto:</p>
<ul>
<li>
<p><strong>Deployments:</strong> Un "Deployment" en Kubernetes es un objeto que permite declarar y gestionar la implementación de aplicaciones en un clúster. Proporciona funcionalidades como estrategias de despliegue, escalabilidad y rollbacks, facilitando la gestión del ciclo de vida de las aplicaciones en entornos contenerizados.</p>
</li>
<li>
<p><strong>Service:</strong> Un "Service" en Minikube es como un operador de tráfico para tus aplicaciones en Kubernetes. Le da a tus aplicaciones una dirección fija y fácil de recordar para que puedan comunicarse entre sí sin importar dónde estén ejecutándose. También puede repartir el tráfico entre varias partes de tu aplicación para mantener las cosas equilibradas. En resumen, hace que sea más fácil para las partes de tu aplicación encontrarse y hablar entre sí.</p>
</li>
<li>
<p><strong>Ingress:</strong> es un recurso de Kubernetes que proporciona una forma de gestionar y controlar el acceso externo a los servicios que están dentro de un
clúster de Kubernetes. A través de Ingress, se definen reglas que permiten redirigir el tráfico de entrada (por ejemplo, HTTP o HTTPS) a los servicios
internos del clúster basándose en criterios como la URL, el host, o el puerto.</p>
</li>
</ul>
<p><a href="../coding/implementacion_yml/"><em>Enlace a Scripts</em></a></p>
<h2 id="uso-del-comando-socat">Uso del comando socat</h2>
<p>Se utilizo la herramienta "socat" para que la PC anfitriona física pueda redirigir el
tráfico de solicitudes al puerto despecificado como NodePort en el ingress del cluster. Esto se debe hacer ya que el cluster está
aislado dentro de la PC anfitriona y nadie desde fuera puede llegar de forma directa. El
comando que se utiliza es el siguiente:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1">#Para ver el puerto del ingress</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-A
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>socat<span class="w"> </span>tcp-listen:<span class="s2">&quot;puerto PC Host&quot;</span>,bind<span class="o">=</span><span class="s2">&quot;IP del Host&quot;</span>,reuseaddr,fork<span class="w"> </span>tcp4:<span class="s2">&quot;Minikube IP&quot;</span>:<span class="s2">&quot;Puerto ingress&quot;</span>
</span></code></pre></div>
<h2 id="configuracion-en-el-cliente">Configuracion en el cliente:</h2>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/hosts
</span></code></pre></div>
Luego, en ese archivo se agrega la IP del servidor y el nombre de la app:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="s2">&quot;IP host&quot;</span><span class="w"> </span>miapp.local
</span></code></pre></div>
<h2 id="generacion-de-trafico">Generacion de trafico</h2>
<p>Para la generacion de trafico por parte de los clientes se empleo un codigo que simula la carga enviando solicitudes HTTP asíncronas a la URL del servidor donde se aloja el cluster y el puerto del mismo, durante un periodo de tiempo determinado.
Las solicitudes se generan basadas en una distribucion de tiempos exponencial, simulando el trafico web con tiempos de arribo aleatorios.</p>
<p><a href="../coding/implementacion_py/#generador-de-trafico"><em>Mas informacion</em></a></p>
<h2 id="balanceador-de-cargas">Balanceador de cargas</h2>
<p>Para gestionar todas las solicitudes entrantes y aprovechar la escalabilidad de la nube, modelamos el balanceador de carga como un sistema de colas M/M/1. En este modelo, la cola tiene capacidad infinita y las solicitudes de tareas llegan de manera individual.
Las llegadas de tareas siguen un proceso de Poisson con una tasa λ, lo que significa que los tiempos entre llegadas son independientes y siguen una distribución exponencial con una media de 1/λ. Por otro lado, los tiempos de servicio en el servidor del balanceador de carga también siguen una distribución exponencial, con un parámetro de velocidad μ, donde 1/μ representa el tiempo medio de servicio.
En este contexto:</p>
<ul>
<li>
<p>La primera "M" representa el proceso de arribo de solicitudes, el cual puede ser controlado mediante el codigo en Python del generador de tráfico, ajustando el tiempo entre llegadas.</p>
</li>
<li>
<p>La segunda "M" corresponde al proceso de servicio, que también sigue una distribución exponencial, determinada por el tiempo de atención de cada solicitud en el script de la aplicación del servidor en python.</p>
</li>
</ul>
<p>Para esta implementación, se emplea una única máquina física (PM) y se asume que la cola en NGINX tiene capacidad infinita, lo que permite analizar el comportamiento del sistema sin restricciones de perdidas en la cola.</p>
<h2 id="nodos">Nodos</h2>
<p>En esta etapa, el proceso de arribo también se modela con "M", donde la nueva tasa de
llegada se calcula dividiendo la tasa de arribo total entre la cantidad de nodos trabajadores
(worker nodes). En cuanto al proceso de servicio, se presenta una situación similar a la de
NGINX, donde es complicado determinar la distribución exacta que rige este proceso. Esto
se debe a que el servicio puede depender de factores que no son fácilmente controlables,
como la configuración y el comportamiento del sistema en los nodos trabajadores.</p>
<p>Al definir la capacidad del sistema "C", se aclara que Kubernetes no gestiona colas de
tareas, por lo que inicialmente C=1. Aunque esto podría llevar a pérdidas en cada nodo, en
la práctica no se observan pérdidas debido al protocolo TCP sobre HTTP, que garantiza la
transmisión de tareas a costa de mayor latencia. Esto se logra mediante herramientas como
el control de ventana y la retransmisión, lo que puede generar colas tanto en el cliente como
en el servidor.</p>
<h2 id="pods-servidores">PODs / Servidores</h2>
<p>Los pods dentro de un nodo se pueden representar por un modelo de colas M/M/k/k
, la primera "M" en notacion de Kendall representa la tasa de arrivo divida por la cantidad de contenedores. </p>
<p>La segunda "M" representa el tiempo de procesamiento del pod definido en la app del servidor FastAPI siguiendo una distribucion exponencial, lo cual es modificable.
Con relacion a la cantidad de servidores, se tienen "k" de los mismos representado por la cantidad de pods  que pueden atender solicitudes en simultaneo, en este caso son los encargados de procesar las solicitudes de tareas.</p>
<p>Por otro lado, se considero a cada pod como un único servidor, por lo que cada uno puede resolver una solicitud a la vez, las nuevas solicitudes deben esperar en cola hasta que el pod este disponible. Por eso la capacidad maxima de la cola tambien se verá limitada por la cantidad de servidores "k" (pods), entonces si todos los servidores estan procesando solicitudes y se alcanza el limite, las nuevas solicitudes se rechazan o se enrutan hacia otro nodo.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "content.code.annotation", "content.code.copy", "content.tabs.link", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": ["python", "bash", "yaml"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>